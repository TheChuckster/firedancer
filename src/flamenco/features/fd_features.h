#ifndef HEADER_fd_src_flamenco_features_fd_features_h
#define HEADER_fd_src_flamenco_features_fd_features_h

/* Code generated by gen_features.py. DO NOT EDIT. */

#include "../fd_flamenco_base.h"

#define FD_FEATURE_ACTIVE(_g, _y)  ((_g->features. _y != 0) && (_g->bank.slot >= _g->features. _y))

/* fd_features_t is the current set of enabled feature flags.

   Each feature has a corresponding account in the account database,
   which are used to control activation.  This structure tracks all
   features implemented for convenience.  Parameters of this structure
   change over time, as activated features become default, and as new
   pending feature activations get added. */

struct fd_features {
  ulong account_hash_ignore_slot;
  ulong add_compute_budget_program;
  ulong add_get_minimum_delegation_instruction_to_stake_program;
  ulong add_get_processed_sibling_instruction_syscall;
  ulong add_set_compute_unit_price_ix;
  ulong add_set_tx_loaded_accounts_data_size_instruction;
  ulong add_shred_type_to_shred_seed;
  ulong allow_votes_to_directly_update_vote_state;
  ulong apply_cost_tracker_during_replay;
  ulong bank_transaction_count_fix;
  ulong blake3_syscall_enabled;
  ulong bpf_account_data_direct_mapping;
  ulong cap_accounts_data_allocations_per_transaction;
  ulong cap_accounts_data_len;
  ulong cap_accounts_data_size_per_block;
  ulong cap_bpf_program_instruction_accounts;
  ulong cap_transaction_accounts_data_size;
  ulong check_init_vote_data;
  ulong check_physical_overlapping;
  ulong check_slice_translation_size;
  ulong check_syscall_outputs_do_not_overlap;
  ulong checked_arithmetic_in_fee_validation;
  ulong clean_up_delegation_errors;
  ulong commission_updates_only_allowed_in_first_half_of_epoch;
  ulong compact_vote_state_updates;
  ulong credits_auto_rewind;
  ulong curve25519_syscall_enabled;
  ulong dedupe_config_program_signers;
  ulong default_units_per_instruction;
  ulong delay_visibility_of_program_deployment;
  ulong demote_program_write_locks;
  ulong deprecate_rewards_sysvar;
  ulong disable_bpf_deprecated_load_instructions;
  ulong disable_bpf_unresolved_symbols_at_runtime;
  ulong disable_builtin_loader_ownership_chains;
  ulong disable_cpi_setting_executable_and_rent_epoch;
  ulong disable_deploy_of_alloc_free_syscall;
  ulong disable_deprecated_loader;
  ulong disable_fee_calculator;
  ulong disable_fees_sysvar;
  ulong disable_rehash_for_rent_epoch;
  ulong disable_turbine_fanout_experiments;
  ulong do_support_realloc;
  ulong drop_merkle_shreds;
  ulong drop_redundant_turbine_path;
  ulong ed25519_program_enabled;
  ulong enable_alt_bn128_syscall;
  ulong enable_big_mod_exp_syscall;
  ulong enable_bpf_loader_extend_program_ix;
  ulong enable_bpf_loader_set_authority_checked_ix;
  ulong enable_durable_nonce;
  ulong enable_early_verification_of_account_modifications;
  ulong enable_partitioned_epoch_reward;
  ulong enable_program_redeployment_cooldown;
  ulong enable_request_heap_frame_ix;
  ulong enable_turbine_fanout_experiments;
  ulong epoch_accounts_hash;
  ulong error_on_syscall_bpf_function_hash_collisions;
  ulong evict_invalid_stakes_cache_entries;
  ulong executables_incur_cpi_data_cost;
  ulong filter_stake_delegation_accounts;
  ulong filter_votes_outside_slot_hashes;
  ulong fix_recent_blockhashes;
  ulong fixed_memcpy_nonoverlapping_check;
  ulong full_inflation_devnet_and_testnet;
  ulong full_inflation_mainnet_certusone_vote;
  ulong full_inflation_mainnet_certusoneenable;
  ulong include_account_index_in_rent_error;
  ulong include_loaded_accounts_data_size_in_fee_calculation;
  ulong increase_tx_account_lock_limit;
  ulong incremental_snapshot_only_incremental_hash_calculation;
  ulong instructions_sysvar_owned_by_sysvar;
  ulong keep_merkle_shreds;
  ulong last_restart_slot_sysvar;
  ulong leave_nonce_on_success;
  ulong libsecp256k1_0_5_upgrade_enabled;
  ulong libsecp256k1_fail_on_bad_count;
  ulong libsecp256k1_fail_on_bad_count2;
  ulong limit_max_instruction_trace_length;
  ulong limit_secp256k1_recovery_id;
  ulong loosen_cpi_size_restriction;
  ulong max_tx_account_locks;
  ulong merge_nonce_error_into_system_error;
  ulong move_serialized_len_ptr_in_cpi;
  ulong native_programs_consume_cu;
  ulong no_overflow_rent_distribution;
  ulong nonce_must_be_advanceable;
  ulong nonce_must_be_authorized;
  ulong nonce_must_be_writable;
  ulong on_load_preserve_rent_epoch_for_rent_exempt_accounts;
  ulong optimize_epoch_boundary_updates;
  ulong pico_inflation;
  ulong preserve_rent_epoch_for_rent_exempt_accounts;
  ulong prevent_calling_precompiles_as_programs;
  ulong prevent_crediting_accounts_that_end_rent_paying;
  ulong prevent_rent_paying_rent_recipients;
  ulong quick_bail_on_panic;
  ulong record_instruction_in_transaction_context_push;
  ulong reduce_required_deploy_balance;
  ulong reject_callx_r10;
  ulong reject_empty_instruction_without_program;
  ulong reject_non_rent_exempt_vote_withdraws;
  ulong reject_vote_account_close_unless_zero_credit_epoch;
  ulong relax_authority_signer_check_for_lookup_table_creation;
  ulong remove_bpf_loader_incorrect_program_id;
  ulong remove_congestion_multiplier_from_fee_calculation;
  ulong remove_deprecated_request_unit_ix;
  ulong remove_native_loader;
  ulong rent_for_sysvars;
  ulong requestable_heap_size;
  ulong require_custodian_for_locked_stake_authorize;
  ulong require_rent_exempt_accounts;
  ulong require_static_program_ids_in_transaction;
  ulong return_data_syscall_enabled;
  ulong round_up_heap_size;
  ulong secp256k1_program_enabled;
  ulong secp256k1_recover_syscall_enabled;
  ulong send_to_tpu_vote_port;
  ulong separate_nonce_from_blockhash;
  ulong set_exempt_rent_epoch_max;
  ulong simplify_writable_program_account_check;
  ulong skip_rent_rewrites;
  ulong sol_log_data_syscall_enabled;
  ulong spl_associated_token_account_v1_0_4;
  ulong spl_associated_token_account_v1_1_0;
  ulong spl_token_v2_multisig_fix;
  ulong spl_token_v2_self_transfer_fix;
  ulong spl_token_v2_set_authority_fix;
  ulong spl_token_v3_3_0_release;
  ulong spl_token_v3_4_0;
  ulong stake_allow_zero_undelegated_amount;
  ulong stake_deactivate_delinquent_instruction;
  ulong stake_merge_with_unmatched_credits_observed;
  ulong stake_minimum_delegation_for_rewards;
  ulong stake_program_advance_activating_credits_observed;
  ulong stake_raise_minimum_delegation_to_1_sol;
  ulong stake_redelegate_instruction;
  ulong stake_split_uses_rent_sysvar;
  ulong stakes_remove_delegation_if_inactive;
  ulong stop_sibling_instruction_search_at_parent;
  ulong stop_truncating_strings_in_syscalls;
  ulong switch_to_new_elf_parser;
  ulong syscall_saturated_math;
  ulong system_transfer_zero_check;
  ulong tx_wide_compute_cap;
  ulong update_hashes_per_tick;
  ulong update_rewards_from_cached_accounts;
  ulong update_syscall_base_costs;
  ulong use_default_units_in_fee_calculation;
  ulong verify_tx_signatures_len;
  ulong versioned_tx_message_enabled;
  ulong vote_authorize_with_seed;
  ulong vote_stake_checked_instructions;
  ulong vote_state_add_vote_latency;
  ulong vote_state_update_credit_per_dequeue;
  ulong vote_state_update_root_fix;
  ulong vote_withdraw_authority_may_change_authorized_voter;
  ulong warp_timestamp_again;
  ulong warp_timestamp_with_a_vengeance;
  ulong zk_token_sdk_enabled;
};
typedef struct fd_features fd_features_t;

/* fd_feature_id_t maps a feature ID (account address) to the byte
   byte offset in fd_features_t. */

struct fd_feature_id {
  ulong       offset;  /* offset of feature in fd_features_t
                          ULONG_MAX is sentinel */
  fd_pubkey_t id;      /* pubkey of feature */
};
typedef struct fd_feature_id fd_feature_id_t;

FD_PROTOTYPES_BEGIN

/* fd_feature_ids is the list of known feature IDs.
   The last element has offset==ULONG_MAX. */
extern fd_feature_id_t const ids[];

/* fd_features_enable_{...} enables a specific set of features. */

void fd_features_enable_testnet( fd_features_t * );
void fd_features_enable_devnet ( fd_features_t * );
void fd_features_enable_mainnet ( fd_features_t * );
void fd_features_enable_v13    ( fd_features_t * );
void fd_features_enable_v14    ( fd_features_t * );
void fd_features_enable_v16    ( fd_features_t * );
void fd_features_enable_v17    ( fd_features_t * );
void fd_features_enable_all    ( fd_features_t * );

/* fd_feature_iter_Ellipsis is an iterator-style API over all supported
   features in this version of Firedancer.  Usage:

     for( fd_feature_id_t const * id = fd_feature_iter_init();
                                      !fd_feature_iter_done( id );
                                  id = fd_feature_iter_next( id ) ) {
       ...
     } */

static inline fd_feature_id_t const *
fd_feature_iter_init( void ) {
  return ids;
}

static inline int
fd_feature_iter_done( fd_feature_id_t const * id ) {
  return id->offset == ULONG_MAX;
}

static inline fd_feature_id_t const *
fd_feature_iter_next( fd_feature_id_t const * id ) {
  return id+1;
}

static inline ulong *
fd_features_ptr( fd_features_t *         features,
                 fd_feature_id_t const * id ) {
  return (ulong *)( (ulong)features + id->offset );
}

static inline ulong const *
fd_features_ptr_const( fd_features_t const *   features,
                       fd_feature_id_t const * id ) {
  return (ulong const *)( (ulong)features + id->offset );
}

FD_PROTOTYPES_END

#endif /* HEADER_fd_src_flamenco_features_fd_features_h */

